<modification>
	<id>System edit</id>
	<version>2.0.x</version>
	<vqmver>1.0</vqmver>
	<author>Bommer Luu</author>
	<file name="catalog/controller/common/seo_url.php">
		<operation>
			<search position="replace"><![CDATA[
				$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE `query` = 'category_id=" . (int)$category . "'");
			]]></search>
			<add><![CDATA[
				$query = $this->db->query("SELECT * FROM " . DB_PREFIX . "url_alias WHERE `query` = 'category_id=" . (int)$category . "' OR `query` = 'news_category_id=" . (int)$category . "'");
			]]></add>
		</operation>
		<operation>
			<search position="replace"><![CDATA[
				if (($data['route'] == 'product/product' && $key == 'product_id') || (($data['route'] == 'product/manufacturer/info' || $data['route'] == 'product/product') && $key == 'manufacturer_id') || ($data['route'] == 'information/information' && $key == 'information_id')) {
			]]></search>
			<add><![CDATA[
				if (($data['route'] == 'product/product' && $key == 'product_id') || (($data['route'] == 'product/manufacturer/info' || $data['route'] == 'product/product') && $key == 'manufacturer_id') || ($data['route'] == 'information/information' && $key == 'information_id') || ($data['route'] == 'news/news' && $key == 'news_id')) {
			]]></add>
		</operation>
		<operation>
			<search position="before"><![CDATA[
				if ($query->row['query'] && $url[0] != 'information_id'
			]]></search>
			<add><![CDATA[
				if ($url[0] == 'news_id') {
					$this->request->get['news_id'] = $url[1];
				}

				if ($url[0] == 'news_category_id') {
					if (!isset($this->request->get['npath'])) {
						$this->request->get['npath'] = $url[1];
					} else {
						$this->request->get['npath'] .= '_' . $url[1];
					}
				}
			]]></add>
		</operation>
		<operation>
			<search position="replace"><![CDATA[
				if ($query->row['query'] && $url[0] != 'information_id' && $url[0] != 'manufacturer_id' && $url[0] != 'category_id' && $url[0] != 'product_id') {
			]]></search>
			<add><![CDATA[
				if ($query->row['query'] && $url[0] != 'information_id' && $url[0] != 'manufacturer_id' && $url[0] != 'category_id' && $url[0] != 'product_id' && $url[0] != 'news_id' && $url[0] != 'news_category_id') {
			]]></add>
		</operation>
		<operation>
			<search position="before"><![CDATA[
				elseif (isset($this->request->get['path'])) {
			]]></search>
			<add><![CDATA[
				} elseif (isset($this->request->get['news_id'])) {
					$this->request->get['route'] = 'news/news';
				} elseif (isset($this->request->get['npath'])) {
					$this->request->get['path'] = $this->request->get['npath'];
					$this->request->get['route'] = 'news/category';
			]]></add>
		</operation>
	</file>
	<file name="system/library/url.php">
		<operation>
			<search position="before"><![CDATA[$url .= 'index.php?route=' . $route;]]></search>
			<add><![CDATA[
				if ( $route == 'common/home' && $args == '' ) return $url;
			]]></add>
		</operation>
	</file>
</modification>
